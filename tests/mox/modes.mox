(* mode inference on pairs and sums *)
((unit, (unit, unit)) : (unit *[unique local] (unit * unit)))
> (unit *[u=unique a=local r=r2] (unit *[u=aliased a=global r=r1] unit))
> mode vars
>   r1 ∈ [r0, rinf]
>   r2 ∈ [r0, rinf]

(((left(unit)), (right(unit))) : ((unit +[unique local] empty) * (unit +[unique local] unit)))
> error: mode solver detected uniqueness inconsistency

(* arrow annotations roundtrip *)
((fun f => f) : ((unit ->[local once portable] unit) -> (unit ->[local once portable] unit)))
> ((unit ->[a=local r=r3 l=once p=portable] unit) ->[a=global r=r2 l=many p=nonportable] (unit ->[a=local r=r1 l=once p=portable] unit))
> mode vars
>   r1 ∈ [r0, rinf]
>   r2 ∈ [r0, rinf]
>   r3 ∈ [r0, rinf]

(* redundant mode annotation *)
((unit, unit) : (unit *[global] unit))
> (unit *[u=aliased a=global r=r1] unit)
> mode vars
>   r1 ∈ [r0, rinf]

(* violation: arrow modes stronger than implementation *)
((fun f => f) : ((unit ->[local once] unit) -> (unit ->[local once portable] unit)))
> error: mode solver detected portability inconsistency
